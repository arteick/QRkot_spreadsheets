Онсновные команды для работы с миграциями

1. Создание миграции
Чтобы создать новую миграцию, используйте команду:

alembic revision -m "Описание миграции"

Эта команда создаст новый файл миграции в папке alembic/versions. Файл будет содержать шаблон для upgrade и downgrade методов.

2. Применение миграции
Чтобы применить миграцию и обновить базу данных, используйте команду:

alembic upgrade head

Эта команда применит все миграции до последней (HEAD).

3. Откат миграции
Если нужно откатить последнюю миграцию, используйте команду:

alembic downgrade -1

Эта команда откатит одну последнюю миграцию.

4. Применение конкретной миграции
Если нужно применить или откатить миграцию до конкретной версии, используйте:

alembic upgrade <версия>
alembic downgrade <версия>

5. Просмотр текущей версии
Чтобы узнать текущую версию базы данных, используйте:

alembic current

6. Просмотр истории миграций
Чтобы увидеть список всех миграций и их статус, используйте:

alembic history

7. Автогенерация миграций
Alembic может автоматически генерировать миграции на основе изменений в моделях SQLAlchemy:

alembic revision --autogenerate -m "Описание миграции"

Эта команда сравнит текущее состояние базы данных с моделями SQLAlchemy и создаст миграцию с необходимыми изменениями.

8. Проверка миграций
Чтобы проверить, что миграции корректны, можно использовать команду:

alembic check